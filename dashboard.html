<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; }
        body { background: #f4f7f6; display: flex; justify-content: center; padding: 20px; min-height: 100vh; }
        main { background: white; width: 100%; max-width: 500px; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .resumo { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .card { padding: 15px; border-radius: 10px; color: white; text-align: center; font-size: 0.8rem; }
        .card span { display: block; font-size: 1.1rem; font-weight: bold; }
        .verde { background: #27ae60; } .vermelho { background: #e74c3c; } .azul { background: #3498db; grid-column: span 2; }
        
        /* BOTÃƒO EXCLUIR PADRONIZADO */
        .btn-excluir { 
            background: #ff4757; color: white; border: none; border-radius: 5px; 
            width: 85px; height: 30px; cursor: pointer; font-weight: bold; font-size: 0.7rem;
            margin-top: 5px; transition: 0.2s;
        }
        .btn-excluir:hover { background: #ff6b81; }

        .item-extrato { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        .info { display: flex; flex-direction: column; }
        .valor-box { text-align: right; }
    </style>
</head>
<body>
    <main>
        <h2>ðŸ“Š Resumo</h2>
        <div class="resumo">
            <div class="card verde">Ganhos <span id="tGanhos">R$ 0</span></div>
            <div class="card vermelho">Gastos <span id="tGastos">R$ 0</span></div>
            <div class="card azul">Saldo Atual <span id="saldo">R$ 0</span></div>
        </div>
        <div id="extrato"></div>
        <a href="index.html" style="display:block; text-align:center; margin-top:20px; color:#666; text-decoration:none;">Voltar</a>
    </main>

    <script type="module">
        import { db } from './firebase-config.js';
        import { collection, getDocs, query, orderBy, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js";

        window.excluir = async (id) => {
            if(confirm("Excluir?")) {
                await deleteDoc(doc(db, "transacoes", id));
                location.reload();
            }
        };

        async function carregar() {
            const q = query(collection(db, "transacoes"), orderBy("dataOcorrencia", "desc"));
            const snap = await getDocs(q);
            let g = 0, st = 0, h = "";
            snap.forEach(d => {
                const data = d.data();
                if(data.tipo === 'ganho') g += data.valor; else st += data.valor;
                h += `<div class="item-extrato">
                        <div class="info"><strong>${data.descricao}</strong><small>${data.dataOcorrencia}</small></div>
                        <div class="valor-box">R$ ${data.valor.toFixed(2)}<br>
                        <button class="btn-excluir" onclick="excluir('${d.id}')">Excluir</button></div>
                      </div>`;
            });
            document.getElementById('tGanhos').innerText = `R$ ${g.toFixed(2)}`;
            document.getElementById('tGastos').innerText = `R$ ${st.toFixed(2)}`;
            document.getElementById('saldo').innerText = `R$ ${(g-st).toFixed(2)}`;
            document.getElementById('extrato').innerHTML = h;
        }
        carregar();
    </script>
</body>
</html>
